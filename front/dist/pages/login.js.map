{
  "version": 3,
  "sources": ["../../src/pages/login.ts"],
  "sourcesContent": ["import { cookies } from \"../utils/cookies\";\nimport { checkTokenRefresh } from \"../utils/tokenRefresh\";\nimport \"./login.scss\";\n\ncheckTokenRefresh(false);\nconst loginForm = qs<HTMLFormElement>(\"form\");\nconst errorMessage = qs(\"#error-message\");\n\nfunction next() {\n    const urlParams = new URLSearchParams(window.location.search);\n    const next = urlParams.get(\"next\") || \"page/upload\";\n    window.location.href = window.location.origin + (\"/\" + next).replace(\"//\", \"/\");\n}\n\nif (cookies.token) {\n    const conf = confirm(\"You are already logged in. Do you want to stay logged in?\");\n    if (conf) next();\n} else {\n    qs(\"nav\").style.opacity = \"0\";\n    qs(\"nav ul\").style.pointerEvents = \"none\";\n}\n\nloginForm.on(\"submit\", async (event) => {\n    event.preventDefault();\n    const fd = new FormData(loginForm);\n    const res = await fetch(\"/auth/login\", {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(Object.fromEntries(fd))\n    });\n\n    const data = await res.json();\n\n    if (data.err) {\n        errorMessage.innerHTML = data.msg;\n    } else {\n        localStorage.setItem(\"tokenExpiresAt\", data.expiresAt);\n        next();\n    }\n});"],
  "mappings": "yFAIAA,EAAkB,EAAK,EACvB,IAAMC,EAAY,GAAoB,MAAM,EACtCC,EAAe,GAAG,gBAAgB,EAExC,SAASC,GAAO,CAEZ,IAAMA,EADY,IAAI,gBAAgB,OAAO,SAAS,MAAM,EACrC,IAAI,MAAM,GAAK,cACtC,OAAO,SAAS,KAAO,OAAO,SAAS,QAAU,IAAMA,GAAM,QAAQ,KAAM,GAAG,CAClF,CAJSC,EAAAD,EAAA,QAMLE,EAAQ,MACK,QAAQ,2DAA2D,GACtEF,EAAK,GAEf,GAAG,KAAK,EAAE,MAAM,QAAU,IAC1B,GAAG,QAAQ,EAAE,MAAM,cAAgB,QAGvCF,EAAU,GAAG,SAAU,MAAOK,GAAU,CACpCA,EAAM,eAAe,EACrB,IAAMC,EAAK,IAAI,SAASN,CAAS,EAS3BO,EAAO,MARD,MAAM,MAAM,cAAe,CACnC,OAAQ,OACR,QAAS,CACL,eAAgB,kBACpB,EACA,KAAM,KAAK,UAAU,OAAO,YAAYD,CAAE,CAAC,CAC/C,CAAC,GAEsB,KAAK,EAExBC,EAAK,IACLN,EAAa,UAAYM,EAAK,KAE9B,aAAa,QAAQ,iBAAkBA,EAAK,SAAS,EACrDL,EAAK,EAEb,CAAC",
  "names": ["checkTokenRefresh", "loginForm", "errorMessage", "next", "__name", "cookies", "event", "fd", "data"]
}
